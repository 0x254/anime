<!DOCTYPE html>
<html>
<head>
  <title>DOM Performances test | anime.js</title>
  <meta charset="utf-8">
  <link href="../assets/css/styles.css" rel="stylesheet">
  <script src="../assets/js/stats.min.js"></script>
  <script src="../../anime.js"></script>
  <style>

    .particule {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 2rem;
      height: 2rem;
      margin: -1rem 0 0 -1rem;
      background: currentColor;
      transform: scale(0);
      border-radius: 50%;
    }

  </style>
</head>
<body></body>
<script>

  var stats = new Stats();
  stats.showPanel(0);
  document.body.appendChild(stats.dom);

  var maxElements = 1000;
  var duration = 3000;
  var toAnimate = [];
  var w = window.innerWidth > window.innerHeight ? window.innerWidth : window.innerHeight;
  var colors = ['#5E89FB', '#B1FF92', '#FB0B5A', '#FFC073'];

  var createElements = (function() {
    var fragment = document.createDocumentFragment();
    for (var i = 0; i < maxElements; i++) {
      var el = document.createElement('div');
      el.classList.add('particule');
      el.style.background = colors[anime.random(0, 3)];
      el.style.transform = 'rotate('+anime.random(-360, 360)+'deg)';
      toAnimate.push(el);
      fragment.appendChild(el);
    }
    document.body.appendChild(fragment);
  })();

  var animate = function(el) {
    anime({
      targets: el,
      rotate: anime.getValue(el,'rotate'),
      translateX: [0, w/2],
      translateY: [0, w/2],
      scale: [0, 4],
      delay: anime.random(0, duration),
      duration: duration,
      easing: 'easeInExpo',
      loop: true
    });
  }

  toAnimate.forEach(animate);

  anime({
    update: function() {
      stats.begin();
      stats.end();
    },
    duration: Infinity
  });

  </script>
</html>
